<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_ui_action">
    <sys_ui_action action="INSERT_OR_UPDATE">
        <action_name>delete_checked</action_name>
        <active>true</active>
        <client>true</client>
        <client_script_v2><![CDATA[function onClick(g_form) {

}]]></client_script_v2>
        <comments>Deletes selected records after confirmation</comments>
        <condition>current.canDelete()</condition>
        <form_action>false</form_action>
        <form_button>false</form_button>
        <form_button_v2>false</form_button_v2>
        <form_context_menu>false</form_context_menu>
        <form_link>false</form_link>
        <form_menu_button_v2>false</form_menu_button_v2>
        <form_style/>
        <hint/>
        <isolate_script>true</isolate_script>
        <list_action>false</list_action>
        <list_banner_button>false</list_banner_button>
        <list_button>false</list_button>
        <list_choice>false</list_choice>
        <list_context_menu>false</list_context_menu>
        <list_link>false</list_link>
        <list_save_with_form_button>false</list_save_with_form_button>
        <list_style/>
        <messages/>
        <name>Delete</name>
        <onclick>confirmAndDeleteFromList()</onclick>
        <order>100</order>
        <script><![CDATA[var tblName;
var ajaxHelper;
var selSysIds;
var sysIdList;
var indx = 0;
var numSel = 0;

function confirmAndDeleteFromList() {
    tblName = g_list.getTableName();
    selSysIds = g_list.getChecked();
    sysIdList = selSysIds.split(',');
    numSel = sysIdList.length;
    
    if(numSel > 0) {
        indx = 0;
        ajaxHelper = new GlideAjax('DeleteRecordAjax');
        getCascadeDeleteTables();
    }
}

function getCascadeDeleteTables() {
    if(sysIdList[indx] != '') {
        ajaxHelper.addParam('sysparm_name', 'getCascadeDeleteTables');
        ajaxHelper.addParam('sysparm_obj_id',sysIdList[indx]);
        ajaxHelper.addParam('sysparm_table_name', tblName);
        ajaxHelper.addParam('sysparm_nameofstack', null);
        ajaxHelper.getXMLAnswer(getCascadeDelTablesDoneList.bind(this), null, null);
    }
}

function getCascadeDelTablesDoneList(answer, s) {
    var delObjList = '';
    var selObjName = '';

    if(answer != '') {     
        var ansrArray = answer.split(';');
        if(ansrArray.length > 1) selObjName = ansrArray[1];
        if(ansrArray.length > 2) delObjList = ansrArray[2];
    }
    
    if(delObjList != '') {
	if(numSel > 1) {
            showListConfDlg("true", selObjName, delObjList);
        } else {
	    showListConfDlg("true" , '', delObjList);
	}

    } else {
   	indx++;
        if(indx < numSel) {
            ajaxHelper.addParam('sysparm_name', 'getCascadeDeleteTables');
            ajaxHelper.addParam('sysparm_table_name', tblName);
	    ajaxHelper.addParam('sysparm_obj_id', sysIdList[indx]);
 	    ajaxHelper.getXMLAnswer(getCascadeDelTablesDoneList.bind(this), null, null);
		} else {
			showListConfDlg("false", '');
		}
    }
}

function showListConfDlg(hasCascadeDel, selObjName, delObjList) {
	var dialogClass = typeof GlideModal != 'undefined' ? GlideModal : GlideDialogWindow;
    var dlg = new dialogClass('delete_confirm_list');
    dlg.setTitle('Confirmation');
    if(delObjList == null) {
        dlg.setWidth(300);
    } else {
        dlg.setWidth(450);
    }
    
    dlg.setPreference('sysparm_obj_list', selSysIds);
    dlg.setPreference('sysparm_table_name', tblName);
    dlg.setPreference('sysparm_has_cascade_del', hasCascadeDel);
    dlg.setPreference('sysparm_sel_obj_name', selObjName);
    dlg.setPreference('sysparm_del_obj_list', delObjList);
    dlg.render();
}
]]></script>
        <show_insert>true</show_insert>
        <show_multiple_update>false</show_multiple_update>
        <show_query>false</show_query>
        <show_update>true</show_update>
        <sys_class_name>sys_ui_action</sys_class_name>
        <sys_created_by>andreas.reermann@atos.net</sys_created_by>
        <sys_created_on>2021-07-01 06:43:41</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>f2dbf5c2db413850689c22d4059619c6</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>Delete</sys_name>
        <sys_overrides display_value="Delete">3f477b0bdb3fdf402c528e686896191d</sys_overrides>
        <sys_package display_value="RTSM" source="x_atpu_rtsm">35d6a18cdb631010689c22d40596190f</sys_package>
        <sys_policy/>
        <sys_scope display_value="RTSM">35d6a18cdb631010689c22d40596190f</sys_scope>
        <sys_update_name>sys_ui_action_f2dbf5c2db413850689c22d4059619c6</sys_update_name>
        <sys_updated_by>andreas.reermann@atos.net</sys_updated_by>
        <sys_updated_on>2021-07-01 06:44:32</sys_updated_on>
        <table>x_atpu_rtsm_ci_state_persistency</table>
        <ui11_compatible>true</ui11_compatible>
        <ui16_compatible>true</ui16_compatible>
    </sys_ui_action>
</record_update>
